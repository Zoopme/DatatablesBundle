{##
 # This file is part of the SgDatatablesBundle package.
 #
 # (c) stwe <https://github.com/stwe/DatatablesBundle>
 #
 # For the full copyright and license information, please view the LICENSE
 # file that was distributed with this source code.
 #}
{%- set datetime_id_selector -%}
    sg-datatables-{{ datatable_name }}-datetime-{{ row_id }}
{%- endset -%}

{%- set datetime_selector -%}
    id="{{ datetime_id_selector }}"
{%- endset -%}

{% if column_class_editable_selector is defined %}
    <span {{ datetime_selector }} class="{{ column_class_editable_selector }}" data-pk="{{ pk }}" {% if path is not same as(null) %}data-path="{{ path }}"{% endif %}></span>
{% else %}
    <span {{ datetime_selector }}>
        {% if data is same as(null) and default_content is not same as(null) %}
            {{ default_content }}
        {% endif %}
    </span>
{% endif %}

{% if data is not same as(null) %}
    <script type="text/javascript">
        $(function() {
            moment.locale("{{ app.request.locale }}");
            
            {# Using id tag selector instead of hashtag to select duplicate ids #}
            {# See https://stackoverflow.com/questions/8498579/how-does-jquery-work-when-there-are-multiple-elements-with-the-same-id-value #}
            {% if timeago is same as(false) %}
                $("[id='{{ datetime_id_selector }}']").html(moment.unix({{ data|date('U') }}).format("{{ date_format }}"));
            {% else %}
                $("[id='{{ datetime_id_selector }}']").html(moment.unix({{ data|date('U') }}).fromNow());
            {% endif %}
        });
    </script>
{% endif %}
